# 📈 Alpaca API 기반 S&P 500 자동 매매 시스템 (Paper Trading)

## 1. 프로그램 기획 및 목적
**프로젝트 기획: 평소 주식 투자에 대한 관심이 많았으나, 방대한 시장 데이터 속에서 매수/매도 타이밍을 수동으로 결정하는 데 한계를 느꼈습니다. 이에 따라, **인간의 감정이 배제된 객관적인 기준(정량적 지표)에 따라 움직이는 자동화된 투자 시스템**을 구축하여, 효율적인 투자 의사 결정 과정을 코드로 구현하는 것을 목표로 본 프로젝트를 기획했습니다.
**프로젝트 목표:** Python 언어와 Alpaca API를 활용하여 S&P 500 종목 중 특정 매수 조건을 만족하는 종목을 자동으로 필터링하고 모의 주문(Paper Trading)을 실행하는 시스템을 구축했습니다.

단순한 데이터 분석을 넘어, `alpaca-py` 라이브러리를 통해 **인증-데이터 수집-전략 검증-주문 실행-계좌 모니터링**의 전 과정을 자동화한 엔드투엔드(End-to-End) 시스템을 구현했습니다. 이 과정에서 발생한 복잡한 API 인증 오류(`401 Unauthorized`) 및 데이터 불완전성 문제를 해결하여 시스템의 안정성을 확보했습니다.

## 2. 매매 전략 및 로직 설명

본 프로그램은 `sp500_companies.csv` 파일의 S&P 500 종목을 순회하며 매매 조건을 확인합니다.

| 구분 | 내용 |
| :--- | :--- |
| **주문 환경** | Alpaca Paper Trading (모의 투자) |
| **종목 대상** | S&P 500 전 종목 (CSV 파일 로드) |
| **최종 매수 조건** | **가장 최근 종가가 그 직전 봉의 종가보다 높은 모든 종목** (시스템 주문 기능 작동 검증을 위해 단순화된 조건 사용) |
| **주문 실행** | 조건 만족 시 해당 종목 1주를 시장가(Market Order)로 매수 주문 실행. |

## 3. 실행 결과 및 주문 증명

다양한 복잡한 전략에서 신호를 찾지 못한 문제를 해결하고, 최종적으로 S&P 500 종목에서 조건을 만족하는 매수 신호를 포착하고 주문을 성공적으로 Alpaca 서버에 전송했음을 증명합니다.

https://youtu.be/GWCBkolea8Q - 유튜브 링크(코드실행 - 500개의 종목을 조건에 맞게 분석하다 보니까 시간이 걸려서 4배속했습니다. 화면을 멈추고 코드 실행 과정을 봐주세요.)

매수 완료된 이미지
<img width="1563" height="833" alt="image" src="https://github.com/user-attachments/assets/99080bf0-128c-4fde-87e9-df75128acdad" />
<img width="1574" height="845" alt="image" src="https://github.com/user-attachments/assets/1c916c09-2e2d-4647-96bd-8ea06ab1bd34" />
<img width="898" height="553" alt="image" src="https://github.com/user-attachments/assets/08e4a2f9-f90d-4ea3-be42-0f1034504202" />



## 4. 향후 발전 계획 (Future Work)

본 프로젝트는 자동 매매 시스템의 기본적인 작동(데이터 수집, 조건 검증, 주문 전송)을 검증하는 데 중점을 두었으나, 추후 다음과 같은 방향으로 전략과 기능을 고도화할 계획입니다.

### 1. 창의적이고 심화된 매매 전략 도입

시스템의 안정성 확인을 위해 단순 조건(일일 상승)을 사용했지만, 추후에는 금융 투자의 거장들(예: 워렌 버핏의 가치 투자, 조지 소로스의 추세 추종, 피터 린치의 성장주 투자)의 매매법을 계량화된 조건으로 만들어 자동 매매에 적용할 계획입니다.

* **가치 투자 기반:** BPS(주당 순자산), PBR(주가순자산비율), ROE(자기자본 이익률) 등의 **재무 지표를 활용**하여 저평가된 우량주를 발굴하는 전략 개발.
* **복합 지표 활용:** **볼린저 밴드, MACD** 등의 다양한 기술적 지표를 조합하여 시장의 과열/과매도 상태를 더 정확하게 포착하는 조건식 도입.

### 2. 실전 투자를 위한 시스템 고도화

Paper Trading을 넘어 실제 투자에 활용 가능한 수준의 시스템으로 발전시킬 계획입니다.

* **실시간 주문 처리:** 현재 확정된 일봉 데이터 대신, Alpaca API의 **실시간 스트리밍(Real-time Streaming)** 데이터를 활용하여 장중에도 즉각적인 매매 결정을 내릴 수 있는 로직 구현.
* **리스크 관리 기능:** 주문 시 손절매, 이익 실현 주문을 동시에 설정하여 리스크를 관리하는 OCO 주문 로직을 추가하여 실제 자금을 사용하는 자동 트레이딩 코드 제작.
* **백테스팅:** 과거 데이터를 기반으로 현재 개발한 전략의 수익률과 위험도를 미리 측정하는 백테스팅 기능을 추가하여 전략의 객관적인 성능을 검증할 예정입니다.
